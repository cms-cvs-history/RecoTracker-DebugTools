process TESTOUTLIERS = {

    service = MessageLogger {
	untracked vstring destinations = {"cout"}
	untracked vstring categories    = { "FwkSummary","RFIOFile","FwkReport","TestOutliers"}
	untracked PSet cout            = {
 	    untracked PSet default   = { untracked int32 limit = 0  }
	    untracked PSet FwkSummary = { untracked int32 limit = -1 }
	    untracked PSet RFIOFile = { untracked int32 limit = -1 }
            untracked PSet FwkReport =  { untracked int32 limit = -1
	                                  untracked int32 reportEvery = 10 }
	}
    }
    
    untracked PSet maxEvents = {untracked int32 input = -1}
    source = PoolSource { 
	untracked vstring fileNames = {
	    'file:single_mu_10_1.root'
	}
    }

    # Track Associators
    include "SimTracker/TrackAssociation/data/TrackAssociatorByChi2.cfi"
    include "SimTracker/TrackAssociation/data/TrackAssociatorByHits.cfi"

    # Filters
    include "Validation/RecoTrack/data/cuts.cff"

    # Track Validator    
    include "Validation/RecoTrack/data/MultiTrackValidator.cff"
    replace multiTrackValidator.label = {cutsCKF}
    replace multiTrackValidator.out = "validTtbar160cut-1.root"

    replace cutsCKF.src = ctfWithMaterialTracks::TESTOUTLIERS
    replace cutsTPFake.src = trackingParticles
    replace cutsTPEffic.src = trackingParticles

    include "SimGeneral/MixingModule/data/mix_none.cfi"

    service = Timing { 	untracked bool summaryOnly = true } 
    untracked PSet options = {
	untracked bool wantSummary = true
	untracked bool makeTriggerResults = false  
    }
    include "RecoTracker/Configuration/data/RecoTracker.cff"

    include "CalibTracker/Configuration/data/Tracker_FakeAlignment.cff"
    include "CalibTracker/Configuration/data/SiPixel_FakeGain.cff"
    include "CalibTracker/Configuration/data/SiStrip_FakeGain.cff"
    include "CalibTracker/Configuration/data/SiStrip_FakeNoise.cff"
    include "CalibTracker/Configuration/data/SiStrip_FakeLorentzAngle.cff"
    include "CalibTracker/Configuration/data/SiStrip_FakePedestals.cff"

    replace KFFittingSmoother.EstimateCut = -1
    replace KFFittingSmoother.MinNumberOfHits = 3

    include "RecoLocalTracker/SiPixelRecHits/data/PixelCPETemplateReco.cfi"
    replace ttrhbwr.PixelCPE = "PixelCPETemplateReco"
    replace MeasurementTracker.PixelCPE = "PixelCPETemplateReco"
    replace MeasurementTracker.StripCPE = "StripCPEfromTrackAngle"

    module test = TestOutliers {
        untracked InputTag tracksOut = ctfWithMaterialTracks::TESTOUTLIERS
        untracked InputTag tracksOld = ctfWithMaterialTracks
        untracked InputTag tp = cutsTPFake
        string  out   = "testT-1.root"
        PSet    RecoTracksCuts = {
           double ptMin = 0.1
           double minRapidity =-5
           double maxRapidity = 5
           double tip = 120
           double lip = 300
           int32  minHit = 3
	   double maxChi2 = 10000 
	   string quality = "loose"
        }
        PSet TrackAssociatorByHitsPSetOld = {
           bool associateStrip = true
           bool associatePixel = true
           bool associateRecoTracks = true
           bool AbsoluteNumberOfHits = false
	   string SimToRecoDenominator = "sim"
	   double MinHitCut = 0.5
	   bool UsePixels = true
	   bool UseGrouped = true
	   bool UseSplitting = true
	   bool ThreeHitTracksAreSpecial = true
           vstring ROUList = {
              #For running only strip or pixel comment out the appropriate strings
              #TIB
              "TrackerHitsTIBLowTof","TrackerHitsTIBHighTof",
              #TID
              "TrackerHitsTIDLowTof","TrackerHitsTIDHighTof",
              #TOB
              "TrackerHitsTOBLowTof","TrackerHitsTOBHighTof",
              #TEC
              "TrackerHitsTECLowTof","TrackerHitsTECHighTof",
              #BPIX
              "TrackerHitsPixelBarrelLowTof","TrackerHitsPixelBarrelHighTof",
              #FPIX
              "TrackerHitsPixelEndcapLowTof","TrackerHitsPixelEndcapHighTof"}
        }
        PSet TrackAssociatorByHitsPSetOut = {
           bool associateStrip = true
           bool associatePixel = true
           bool associateRecoTracks = true
           bool AbsoluteNumberOfHits = false
	   string SimToRecoDenominator = "sim"
	   double MinHitCut = 0.5
	   bool UsePixels = true
	   bool UseGrouped = true
	   bool UseSplitting = true
	   bool ThreeHitTracksAreSpecial = true
           vstring ROUList = {
              #For running only strip or pixel comment out the appropriate strings
              #TIB
              "TrackerHitsTIBLowTof","TrackerHitsTIBHighTof",
              #TID
              "TrackerHitsTIDLowTof","TrackerHitsTIDHighTof",
              #TOB
              "TrackerHitsTOBLowTof","TrackerHitsTOBHighTof",
              #TEC
              "TrackerHitsTECLowTof","TrackerHitsTECHighTof",
              #BPIX
              "TrackerHitsPixelBarrelLowTof","TrackerHitsPixelBarrelHighTof",
              #FPIX
              "TrackerHitsPixelEndcapLowTof","TrackerHitsPixelEndcapHighTof"}
        }
    }

#    path p1 = {ckftracks}
    path p1 = {ctfWithMaterialTracks}
    path p2 = {cutsCKF,cutsTPEffic,cutsTPFake,multiTrackValidator}
    path p3 = {test}
    
}
